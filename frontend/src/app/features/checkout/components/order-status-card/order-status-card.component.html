<div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6 mb-4">
  <div class="flex justify-between items-start mb-4">
    <div>
      <h3 class="font-medium text-gray-900">Order #{{ order().referenceId || order().id }}</h3>
      <p class="text-sm text-gray-500">{{ order().date | date : 'medium' }}</p>
    </div>
    <span
      class="px-3 py-1 rounded-full text-xs font-medium"
      [ngClass]="{
        'bg-green-100 text-green-800': order().status === 'PAID',
        'bg-yellow-100 text-yellow-800': order().status === 'PENDING',
        'bg-red-100 text-red-800': order().status === 'FAILED'
      }"
    >
      {{ order().status }}
    </span>
  </div>

  <div class="mb-4">
    @for (item of order().summary.items; track item.name) {
    <div class="flex justify-between py-2 border-b border-gray-50 last:border-0">
      <span class="text-gray-600">{{ item.name }} x{{ item.quantity }}</span>
      <span class="font-medium">{{ item.price | currency : 'USD' }}</span>
    </div>
    }

    <div class="flex justify-between py-2 border-b border-gray-50 text-sm text-gray-500">
      <span>Tax (19%)</span>
      <span>{{ order().summary.tax | currency : 'USD' }}</span>
    </div>

    <div class="flex justify-between mt-3 pt-3 border-t border-gray-100">
      <span class="font-medium text-gray-900">Total (USD)</span>
      <span class="font-bold text-gray-900">{{
        order().summary.total / 100 | currency : 'USD'
      }}</span>
    </div>

    @if (order().payment?.paidAmount) {
    <div class="mt-2 pt-2 border-t border-dashed border-gray-200 text-sm">
      <div class="flex justify-between text-gray-600 mb-1">
        <span>Transaction Cost</span>
        <span class="font-medium">{{
          order().payment.transactionCost / 100 | currency : order().payment.currency
        }}</span>
      </div>

      <div class="flex justify-between text-emerald-700 mb-1 bg-emerald-50 p-2 rounded-md -mx-2">
        <span class="font-semibold">Paid in {{ order().payment.currency }}</span>
        <span class="font-bold text-lg">{{
          order().payment.paidAmount | currency : order().payment.currency
        }}</span>
      </div>

      <div class="flex justify-between text-gray-500 text-xs">
        <span>Exchange Rate</span>
        <span
          >1 USD = {{ order().payment.exchangeRate | number : '1.0-2' }}
          {{ order().payment.currency }}</span
        >
      </div>
    </div>
    }
  </div>

  @if (['PENDING', 'CREATED'].includes(order().status) && order().payment?.paymentLink) {
  <div class="mt-4">
    <button
      (click)="onRetry()"
      class="w-full bg-blue-600 text-white rounded-lg py-2 text-sm font-medium hover:bg-blue-700 transition-colors"
    >
      Complete Payment
    </button>
  </div>
  }
</div>
